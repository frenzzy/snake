<!doctype html><html lang="en"><head><title>Snake</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="A free, online Snake game written in TypeScript with open source"><meta name="keywords" content="Snake, Game, Online, Free, TypeScript, Open Source"><meta property="og:title" content="Snake"><meta property="og:description" content="A free, online Snake game written in TypeScript with open source"><meta property="og:url" content="https://frenzzy.github.io/snake/"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://frenzzy.github.io/snake/snake.jpg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="675"><meta property="og:type" content="website"><meta property="og:site_name" content="Snake"><meta name="theme-color" content="#222738"><link rel="manifest" href="https://frenzzy.github.io/snake/site.webmanifest"><link rel="icon" href="https://frenzzy.github.io/snake/favicon.ico" sizes="any"><link rel="icon" href="https://frenzzy.github.io/snake/icon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="https://frenzzy.github.io/snake/icon.png"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-TQQ8FKW');</script><style>html{height:100%}body{margin:0;height:100%;background:#222738;color:#6e7888;overscroll-behavior:none}canvas{display:block;width:100%;height:100%;image-rendering:pixelated;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;touch-action:none}iframe{width:0;height:0;display:none;visibility:hidden}p{margin:0;padding:1em;font:700 1em Futura,sans-serif;text-align:center;color:#4cffd7}</style></head><body><noscript><p>You need to enable JavaScript to run this app.</p><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TQQ8FKW"></iframe></noscript><canvas width="360" height="640"></canvas><script>class R{constructor(t){this.game=t;const e=60;this.simulationDelta=1e3/e,this.simulationStep=1/e,this.frameDelta=0,this.lastFrameTime=0,this.requestId=0}simulationDelta;simulationStep;frameDelta;lastFrameTime;requestId;start(){this.requestId||(this.lastFrameTime=performance.now(),this.requestId=requestAnimationFrame(this.animate),this.game.render(1))}stop(){this.requestId&&(cancelAnimationFrame(this.requestId),this.requestId=0)}animate=t=>{this.requestId=requestAnimationFrame(this.animate);const e=t-this.lastFrameTime;if(this.lastFrameTime=t,!(e>1e3)){for(this.frameDelta+=e;this.frameDelta>=this.simulationDelta;)this.game.update(this.simulationStep),this.frameDelta-=this.simulationDelta;this.game.render(this.frameDelta/this.simulationDelta)}}}const{abs:k}=Math;var d=(r=>(r.w="KeyW",r.d="KeyD",r.s="KeyS",r.a="KeyA",r.p="KeyP",r.space="Space",r.arrowUp="ArrowUp",r.arrowRight="ArrowRight",r.arrowDown="ArrowDown",r.arrowLeft="ArrowLeft",r.swipeUp="SwipeUp",r.swipeRight="SwipeRight",r.swipeDown="SwipeDown",r.swipeLeft="SwipeLeft",r.click="Click",r))(d||{});class z{constructor(t){this.game=t,addEventListener("keydown",this.handleKeyDown),addEventListener("keyup",this.handleKeyUp),addEventListener("pointerdown",this.handlePointerDown),addEventListener("contextmenu",this.handleContextMenu)}state=new Set;pressed=new Set;released=new Set;gesture=null;startX=0;startY=0;moveX=0;moveY=0;swipeX=0;swipeY=0;timeout=0;handleKeyDown=t=>{this.state.add(t.code),this.pressed.add(t.code)};handleKeyUp=t=>{this.released.add(t.code)};handlePointerDown=t=>{t.preventDefault(),t.isPrimary&&(addEventListener("pointermove",this.handlePointerMove),addEventListener("pointerup",this.handlePointerUp),addEventListener("pointercancel",this.handlePointerUp),clearTimeout(this.timeout),this.startX=this.moveX=this.swipeX=t.pageX,this.startY=this.moveY=this.swipeY=t.pageY,this.timeout=window.setTimeout(this.click,500))};handlePointerMove=t=>{if(!t.isPrimary)return;this.moveX=t.pageX,this.moveY=t.pageY;const e=t.pageX-this.swipeX,s=t.pageY-this.swipeY,i=k(e),o=k(s),n=10;if(i<n&&o<n)return;const h=i>o?e<0?"SwipeLeft":"SwipeRight":s<0?"SwipeUp":"SwipeDown";h!==this.gesture&&(clearTimeout(this.timeout),this.swipeX=t.pageX,this.swipeY=t.pageY,this.gesture=h,this.state.add(h),this.pressed.add(h),this.timeout=window.setTimeout(this.click,500))};handlePointerUp=t=>{!t.isPrimary||(removeEventListener("pointermove",this.handlePointerMove),removeEventListener("pointerup",this.handlePointerUp),removeEventListener("pointercancel",this.handlePointerUp),clearTimeout(this.timeout),this.startX===t.pageX&&this.startY===t.pageY&&(this.state.add("Click"),this.pressed.add("Click"),this.released.add("Click")),this.gesture&&(this.released.add(this.gesture),this.gesture=null))};handleContextMenu=t=>{t.preventDefault()};click=()=>{this.moveX===this.swipeX&&this.moveY===this.swipeY&&(this.state.add("Click"),this.pressed.add("Click"),this.released.add("Click")),this.swipeX=this.moveX,this.swipeY=this.moveY,this.timeout=window.setTimeout(this.click,84)};update(t){for(const e of this.released)this.state.delete(e);this.pressed.clear(),this.released.clear()}}class A{constructor(t,e){this.game=t,this.object=e,this.objects=[]}object;objects;size=0;maxSize=1024;update(t){let e=!1,s=this.size;for(;s--;){const i=this.objects[s];i.update(t),i.isAlive||(e=!0,this.size--)}e&&this.objects.sort((i,o)=>Number(o.isAlive)-Number(i.isAlive))}render(t){let e=this.size;for(;e--;)this.objects[e].render(t)}create(t){if(this.size>=this.maxSize)return;this.size++;const e=this.objects.length<=this.size,s=e?new this.object(this.game,t):this.objects[this.size-1];return e?this.objects.push(s):s.create(t),s}}class C{constructor(t,e){this.game=t,this.create(e)}x=0;y=0;velX=0;velY=0;width=1;height=1;color="";gravityY=-540;isAlive=!1;create({x:t,y:e,velX:s,velY:i,width:o,height:n,color:h}){this.x=t,this.y=e,this.velX=s,this.velY=i,this.width=o,this.height=n,this.color=h,this.isAlive=!0}update(t){this.width-=18*t,this.height-=18*t,this.x+=this.velX*t,this.y+=this.velY*t,this.velY-=this.gravityY*t,this.width<=0&&this.height<=0&&(this.isAlive=!1)}render(){const t=this.game.context;t.shadowColor=this.color,t.shadowBlur=0,t.globalCompositeOperation="lighter",t.fillStyle=this.color,t.fillRect(this.x,this.y,this.width,this.height),t.globalCompositeOperation="source-over"}}const{random:b,floor:y}=Math;class T{constructor(t){this.game=t,this.pool=new A(t,C)}col=0;row=0;color="";pool;spawn(t){const{cols:e,rows:s}=this.game;this.col=y(b()*e),this.row=y(b()*s);for(const i of t)if(this.col===i.col&&this.row===i.row){this.spawn(t);return}this.color=`hsl(${y(b()*360)},100%,50%)`}kill(){const{gridX:t,gridY:e,gridW:s,gridH:i,cols:o,rows:n}=this.game;for(let h=0;h<20;h++){const a=s/o,l=i/n;this.pool.create({x:t+this.col*a+a/4,y:e+this.row*l+l/4,velX:b()*360-180,velY:b()*360-180,width:a/2,height:l/2,color:this.color})}}update(t){this.pool.update(t)}render(t){const{col:e,row:s,game:i}=this,{context:o,gridX:n,gridY:h,gridW:a,gridH:l,cols:g,rows:v}=i,w=a/g,p=l/v;o.globalCompositeOperation="lighter",o.shadowBlur=20,o.shadowColor=this.color,o.fillStyle=this.color,o.fillRect(n+e*w,h+s*p,w,p),o.globalCompositeOperation="source-over",o.shadowBlur=0,this.pool.render(t)}}const{floor:P}=Math,D="#fff";class L{constructor(t){this.game=t,this.spawn(),t.food.spawn(this.chain)}chain=[{col:0,row:0,color:D}];dir=0;lastDir=0;speed=.5;timer=0;delay=0;spawn(){const{cols:t,rows:e}=this.game;this.chain=[{col:P(t/2),row:P(e/2),color:D}],this.dir=0}update(t){const{game:e,chain:s}=this,i=e.input.pressed,o=i.has(d.arrowUp)||i.has(d.w)||i.has(d.swipeUp),n=i.has(d.arrowRight)||i.has(d.d)||i.has(d.swipeRight),h=i.has(d.arrowDown)||i.has(d.s)||i.has(d.swipeDown),a=i.has(d.arrowLeft)||i.has(d.a)||i.has(d.swipeLeft);let l=this.dir,g=i.has(d.space)||i.has(d.click);if(o&&this.lastDir!==3&&(l=1,g=!0),n&&this.lastDir!==4&&(l=2,g=!0),h&&this.lastDir!==1&&(l=3,g=!0),a&&this.lastDir!==2&&(l=4,g=!0),this.dir=l,!l||(this.timer+=t,this.timer<this.delay&&!g))return;this.delay=g?this.timer+this.speed:this.delay+this.speed;const v=s[s.length-1],{cols:w,rows:p,food:u}=e;let f=v.col+(l===4?-1:l===2?1:0),m=v.row+(l===1?-1:l===3?1:0);f>=w&&(f=0),m>=p&&(m=0),f<0&&(f=w-1),m<0&&(m=p-1);for(let c=0;c<s.length;c++){const x=s[c];if(f===x.col&&m===x.row){e.gameOver();return}}if(f===u.col&&m===u.row){v.color=u.color.replace("100%,50%","50%,90%"),s.push({col:f,row:m,color:D}),u.kill(),u.spawn(s),e.score++,e.score%10===0&&(this.speed*=.9);return}const S=s.length-1;for(let c=0;c<S;c++){const x=s[c+1],X=s[c];X.col=x.col,X.row=x.row}v.col=f,v.row=m,this.lastDir=l}render(t){const{game:e,chain:s}=this,{context:i,gridX:o,gridY:n,gridW:h,gridH:a,cols:l,rows:g}=e,v=h/l,w=a/g;i.shadowBlur=20,i.shadowColor="rgba(255,255,255,.3)";const p=s.length-1;for(let u=p;u>=0;u--){const{col:f,row:m,color:S}=s[u];i.fillStyle=S,i.fillRect(o+f*w,n+m*w,v,w),u===p&&(i.shadowBlur=0)}}}const{min:Y}=Math;class E{canvas;context;width=1;height=1;gridX=0;gridY=0;gridW=1;gridH=1;cols=20;rows=20;score=0;maxScore=Number(localStorage.getItem("maxScore"))||0;paused=!1;resized=!1;isGameOver=!1;input;loop;food;player;constructor(){this.canvas=document.querySelector("canvas"),this.context=this.canvas.getContext("2d",{alpha:!1}),this.context.imageSmoothingEnabled=!1,this.resize(),this.input=new z(this),this.loop=new R(this),this.food=new T(this),this.player=new L(this),addEventListener("resize",this.handleResize),this.loop.start()}handleResize=()=>{this.resized=!1};resize(){if(this.resized)return;this.resized=!0;const{canvas:t,context:e}=this,{width:s,height:i}=t.getBoundingClientRect();this.width=s,this.height=i,t.width=s*devicePixelRatio,t.height=i*devicePixelRatio,e.scale(devicePixelRatio,devicePixelRatio);const o=Y(s*.9,i*.65);this.gridW=o,this.gridH=o,this.gridX=(s-o)/2,this.gridY=(i-o)/2}gameOver(){this.isGameOver=!0,this.maxScore<this.score&&(this.maxScore=this.score,localStorage.setItem("maxScore",`${this.maxScore}`))}update=t=>{this.input.pressed.has(d.p)&&(this.paused=!this.paused),this.isGameOver&&this.input.pressed.size&&(this.isGameOver=!1,this.score=0,this.player.spawn()),this.paused||(this.player.update(t),this.food.update(t)),this.input.update(t)};render=t=>{this.resize();const{context:e,width:s,height:i,gridX:o,gridY:n,gridW:h,gridH:a}=this;e.fillStyle="#222738",e.fillRect(0,0,s,i),e.fillStyle="#181825",e.fillRect(o,n,h,a),e.lineWidth=1,e.strokeStyle="#232332";const l=h/this.cols,g=a/this.rows;for(let c=1;c<this.cols;c++){const x=o+l*c;e.beginPath(),e.moveTo(x,n),e.lineTo(x,n+a),e.stroke()}for(let c=1;c<this.rows;c++){const x=n+g*c;e.beginPath(),e.moveTo(o,x),e.lineTo(o+h,x),e.stroke()}e.closePath(),this.player.render(t),this.food.render(t),e.font=`${Y(a*.05,16)}px Futura,sans-serif`,e.textBaseline="bottom",e.textAlign="left",e.fillStyle="#6e7888";const v=(i-a)/4-Y(i*.01,10);e.fillText("SCORE",o,v),e.textAlign="right",e.fillText("MAX SCORE",o+h,v),e.textBaseline="top",e.textAlign="left",e.font=`bold ${Y(a*.1,32)}px Futura,sans-serif`;const w=(i-a)/4;if(e.fillText(`${this.score}`,o,w),e.textAlign="right",e.fillText(`${this.maxScore}`,o+h,w),e.textBaseline="middle",e.textAlign="center",e.fillText("SNAKE",o+h/2,i-w),this.paused&&!this.isGameOver){e.fillStyle="#4cffd7",e.fillText("PAUSED",s/2,i/2);return}if(!this.isGameOver)return;const p=a*.02,u=o-p,f=n-p,m=h+p*2,S=a+p*2;e.fillStyle="rgba(24,24,37,.9)",e.fillRect(u,f,m,S),e.strokeStyle="#222738",e.lineWidth=p*2,e.strokeRect(u,f,m,S),e.fillStyle="#4cffd7",e.fillText("GAME OVER",s/2,i/2)}}window.game=new E;"serviceWorker"in navigator&&navigator.serviceWorker.register("https://frenzzy.github.io/snake/service-worker.js");</script></body></html>
